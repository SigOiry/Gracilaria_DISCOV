<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.6.33">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="Simon Oiry¹">
    <meta name="author" content="Bede Ffinian Rowe Davies¹">
    <meta name="author" content="Pierre Gernez¹">
    <meta name="author" content="Laurent Barillé¹">
    <meta name="dcterms.date" content="2024-11-20">
    <meta name="keywords" content="Remote Sensing, Invasive species, Coastal Ecosystems, Biodiversity">

    <title>DISCOV-Gracilaria Paper</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      /* CSS for citations */
      div.csl-bib-body { }
      div.csl-entry {
        clear: both;
        margin-bottom: 0em;
      }
      .hanging-indent div.csl-entry {
        margin-left:2em;
        text-indent:-2em;
      }
      div.csl-left-margin {
        min-width:2em;
        float:left;
      }
      div.csl-right-inline {
        margin-left:2em;
        padding-left:1em;
      }
      div.csl-indent {
        margin-left: 2em;
      }    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-07ba0ad10f5680c660e360ac31d2f3b6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-545cdd561de3535e9b364c647f747893.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
     
      <meta name="citation_title" content="DISCOV-Gracilaria Paper">
<meta name="citation_abstract" content="To be Written">
<meta name="citation_keywords" content="Remote Sensing,Invasive species,Coastal Ecosystems,Biodiversity">
<meta name="citation_author" content="Simon Oiry¹">
<meta name="citation_author" content="Bede Ffinian Rowe Davies¹">
<meta name="citation_author" content="Pierre Gernez¹">
<meta name="citation_author" content="Laurent Barillé¹">
<meta name="citation_publication_date" content="2024-11-20">
<meta name="citation_cover_date" content="2024-11-20">
<meta name="citation_year" content="2024">
<meta name="citation_online_date" content="2024-11-20">
<meta name="citation_language" content="en">
<meta name="citation_journal_title" content="Remote Sensing of Environment">
<meta name="citation_reference" content="citation_title=Life history and molecular sequences of gracilaria vermiculophylla (gracilariales, rhodophyta), a new introduction to european waters;,citation_author=Jan Rueness;,citation_publication_date=2005;,citation_cover_date=2005;,citation_year=2005;,citation_issue=1;,citation_volume=44;,citation_journal_title=Phycologia;,citation_publisher=Taylor &amp;amp;amp; Francis;">
<meta name="citation_reference" content="citation_title=Impact of hydrodynamics on community structure and metabolic production of marine biofouling formed in a highly energetic estuary;,citation_author=Aurélie Portas;,citation_author=Nathan Carriot;,citation_author=Annick Ortalo-Magné;,citation_author=Guillaume Damblans;,citation_author=Maxime Thiébaut;,citation_author=Gérald Culioli;,citation_author=Nolwenn Quillien;,citation_author=Jean-François Briand;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_doi=10.1016/j.marenvres.2023.106241;,citation_volume=192;,citation_journal_title=Marine Environmental Research;">
<meta name="citation_reference" content="citation_title=How the origin of sedimentary organic matter impacts the benthic nutrient fluxes in shallow coastal mudflats;,citation_author=Laurent Jeanneau;,citation_author=Emilie Jardé;,citation_author=Justine Louis;,citation_author=Alexandrine Pannard;,citation_author=Marine Liotaud;,citation_author=Françoise Andrieux-Loyer;,citation_author=Gérard Gruau;,citation_author=Florian Caradec;,citation_author=Emilie Rabiller;,citation_author=Nathalie Lebris;,citation_author=Anniet Laverman;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_doi=10.5802/crgeos.228;,citation_volume=355;,citation_journal_title=Comptes Rendus Géoscience;">
<meta name="citation_reference" content="citation_title=Plant landscape and models of french atlantic estuarine systems: Extended summary of the doctoral thesis;,citation_author=Kevin Cianfaglione;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_doi=10.2478/trser-2021-0002;,citation_volume=23;,citation_journal_title=Transylvanian Review of Systematical and Ecological Research;">
<meta name="citation_reference" content="citation_title=Bacterial load mitigation of the shellfish magallana gigas by the marine sponge hymeniacidon perlevis (montagu 1818);,citation_author=Charline Gentric;,citation_author=Pierre Sauleau;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_doi=10.1016/j.rsma.2024.103564;,citation_volume=75;,citation_journal_title=Regional Studies in Marine Science;">
<meta name="citation_reference" content="citation_title=Morpho-sedimentological and dynamic patterns in a ria type estuary: The belon estuary (south brittany, france);,citation_author=Guillaume Michel;,citation_author=Sophie Le Bot;,citation_author=Sandric Lesourd;,citation_author=Robert Lafite;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_issue=2;,citation_doi=10.1080/17445647.2021.1925170;,citation_volume=17;,citation_journal_title=Journal of Maps;">
<meta name="citation_reference" content="citation_title=Morphosedimentary evolution of ria-type estuaries;,citation_author=Pierre Castaing;,citation_author=André Guilcher;,citation_publication_date=1995;,citation_cover_date=1995;,citation_year=1995;,citation_issue=4;,citation_doi=10.1002/esp.3290200408;,citation_volume=20;,citation_journal_title=Earth Surface Processes and Landforms;">
<meta name="citation_reference" content="citation_title=Potential influence of confounding factors (size, salinity) on biomarkers in the sentinel species scrobicularia plana used in programmes monitoring estuarine quality;,citation_author=Olivia Fossi Tankoua;,citation_author=Pierre-Emmanuel Buffet;,citation_author=Jean-Claude Amiard;,citation_author=Claude Amiard-Triquet;,citation_author=Catherine Mouneyrac;,citation_author=Brigitte Berthet;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_issue=7;,citation_doi=10.1007/s11356-011-0479-3;,citation_volume=18;,citation_journal_title=Environmental Science and Pollution Research;">
<meta name="citation_reference" content="citation_title=Multiscale patterns in the diversity and organization of benthic intertidal fauna among french atlantic estuaries;,citation_author=Hugues Blanchet;,citation_author=Benoît Gouillieux;,citation_author=Sandrine Alizier;,citation_author=others;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_doi=10.1016/j.seares.2014.02.014;,citation_volume=90;,citation_journal_title=Journal of Sea Research;">
<meta name="citation_reference" content="citation_title=Fluxes of dissolved inorganic carbon in three estuarine systems of the cantabrian sea (north of spain);,citation_author=T Ortega;,citation_author=R Ponce;,citation_author=J Forja;,citation_author=A Gómez-Parra;,citation_publication_date=2005;,citation_cover_date=2005;,citation_year=2005;,citation_issue=1-4;,citation_volume=53;,citation_journal_title=Journal of Marine Systems;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Sintering behaviour of ceramic bodies from contaminated marine sediments;,citation_author=Maximina Romero;,citation_author=A Andrés;,citation_author=Rebeca Alonso;,citation_author=Javier Viguri;,citation_author=J Ma Rincón;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_issue=8;,citation_volume=34;,citation_journal_title=Ceramics International;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Using a UAV-mounted multispectral camera for the monitoring of marine macrophytes;,citation_author=Alejandro Román;,citation_author=Antonio Tovar-Sánchez;,citation_author=Irene Olivé;,citation_author=Gabriel Navarro;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_volume=8;,citation_journal_title=Frontiers in Marine Science;,citation_publisher=Frontiers Media SA;">
<meta name="citation_reference" content="citation_title=Mapping intertidal oyster farms using unmanned aerial vehicles (UAV) high-resolution multispectral data;,citation_author=Alejandro Román;,citation_author=Hermansyah Prasyad;,citation_author=Simon Oiry;,citation_author=Bede FR Davies;,citation_author=Guillaume Brunier;,citation_author=Laurent Barillé;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_volume=291;,citation_journal_title=Estuarine, Coastal and Shelf Science;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Mapping intertidal microphytobenthic biomass with very high-resolution remote sensing imagery in an estuarine system;,citation_author=Alejandro Román;,citation_author=Simon Oiry;,citation_author=Bede FR Davies;,citation_author=Philippe Rosa;,citation_author=Pierre Gernez;,citation_author=Antonio Tovar-Sánchez;,citation_author=Gabriel Navarro;,citation_author=Vona Méléder;,citation_author=Laurent Barillé;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_journal_title=Science of The Total Environment;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Agisoft metashape;,citation_author=undefined Agisoft;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://www.agisoft.com/;">
<meta name="citation_reference" content="citation_title=A review of photogrammetry and photorealistic 3D models in education from a psychological perspective;,citation_author=Steve Nebel;,citation_author=Maik Beege;,citation_author=Sascha Schneider;,citation_author=Günter Daniel Rey;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_volume=5;,citation_conference_title=Frontiers in education;,citation_conference=Frontiers Media SA;">
<meta name="citation_reference" content="citation_title=Decadal increase in the ecological status of a north-atlantic intertidal seagrass meadow observed with multi-mission satellite time-series;,citation_author=Maria Laura Zoffoli;,citation_author=Pierre Gernez;,citation_author=Laurent Godet;,citation_author=Steef Peters;,citation_author=Simon Oiry;,citation_author=Laurent Barillé;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_volume=130;,citation_journal_title=Ecological Indicators;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=A sentinel watching over inter-tidal seagrass phenology across western europe and north africa;,citation_author=Bede Ffinian Rowe Davies;,citation_author=Simon Oiry;,citation_author=Philippe Rosa;,citation_author=Maria Laura Zoffoli;,citation_author=Ana I Sousa;,citation_author=Oliver R Thomas;,citation_author=Dan A Smale;,citation_author=Melanie C Austen;,citation_author=Lauren Biermann;,citation_author=Martin J Attrill;,citation_author=others;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_issue=1;,citation_volume=5;,citation_journal_title=Communications Earth &amp;amp;amp; Environment;,citation_publisher=Nature Publishing Group UK London;">
<meta name="citation_reference" content="citation_title=Intertidal seagrass extent from sentinel-2 time-series show distinct trajectories in western europe;,citation_author=Bede Ffinian Rowe Davies;,citation_author=Simon Oiry;,citation_author=Philippe Rosa;,citation_author=Maria Laura Zoffoli;,citation_author=Ana I Sousa;,citation_author=Oliver R Thomas;,citation_author=Dan A Smale;,citation_author=Melanie C Austen;,citation_author=Lauren Biermann;,citation_author=Martin J Attrill;,citation_author=others;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_volume=312;,citation_journal_title=Remote Sensing of Environment;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Climate change, human impacts, and coastal ecosystems in the anthropocene;,citation_author=Qiang He;,citation_author=Brian R Silliman;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=19;,citation_volume=29;,citation_journal_title=Current Biology;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Ocean acidification impacts on coastal ecosystem services due to habitat degradation;,citation_author=Jason M Hall-Spencer;,citation_author=Ben P Harvey;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=2;,citation_volume=3;,citation_journal_title=Emerging Topics in Life Sciences;,citation_publisher=Portland Press Ltd.;">
<meta name="citation_reference" content="citation_title=Major threats of pollution and climate change to global coastal ecosystems and enhanced management for sustainability;,citation_author=Yonglong Lu;,citation_author=Jingjing Yuan;,citation_author=Xiaotian Lu;,citation_author=Chao Su;,citation_author=Yueqing Zhang;,citation_author=Chenchen Wang;,citation_author=Xianghui Cao;,citation_author=Qifeng Li;,citation_author=Jilan Su;,citation_author=Venugopalan Ittekkot;,citation_author=others;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_volume=239;,citation_journal_title=Environmental Pollution;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=A global analysis of human settlement in coastal zones;,citation_author=Christopher Small;,citation_author=Robert J Nicholls;,citation_publication_date=2003;,citation_cover_date=2003;,citation_year=2003;,citation_journal_title=Journal of coastal research;,citation_publisher=JSTOR;">
<meta name="citation_reference" content="citation_title=Coastal pollution—an overview;,citation_author=Swapna Mukherjee;,citation_author=Kaushik Kiran Ghosh;,citation_author=Abhra Chanda;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_journal_title=Environmental Oceanography and Coastal Dynamics: Current Scenario and Future Trends;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Valuing ecosystem services in complex coastal settings: An extended ecosystem accounting framework for improved decision-making;,citation_author=Jeremy De Valck;,citation_author=Diane Jarvis;,citation_author=Anthea Coggan;,citation_author=Ella Schirru;,citation_author=Petina Pert;,citation_author=Victoria Graham;,citation_author=Maxine Newlands;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_volume=155;,citation_journal_title=Marine Policy;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Ecological value of coastal habitats for commercially and ecologically important species;,citation_author=Rochelle D Seitz;,citation_author=Håkan Wennhage;,citation_author=Ulf Bergström;,citation_author=Romuald N Lipcius;,citation_author=Tom Ysebaert;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_issue=3;,citation_volume=71;,citation_journal_title=ICES Journal of Marine Science;,citation_publisher=Oxford University Press;">
<meta name="citation_reference" content="citation_title=Quantifying economic value of coastal ecosystem services: A review;,citation_author=Seyedabdolhossein Mehvar;,citation_author=Tatiana Filatova;,citation_author=Ali Dastgheib;,citation_author=Erik De Ruyter van Steveninck;,citation_author=Roshanka Ranasinghe;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1;,citation_volume=6;,citation_journal_title=Journal of marine science and engineering;,citation_publisher=MDPI;">
<meta name="citation_reference" content="citation_title=Current status and future prospects for the assessment of marine and coastal ecosystem services: A systematic review;,citation_author=Camino Liquete;,citation_author=Chiara Piroddi;,citation_author=Evangelia G Drakou;,citation_author=Leigh Gurney;,citation_author=Stelios Katsanevakis;,citation_author=Aymen Charef;,citation_author=Benis Egoh;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_issue=7;,citation_volume=8;,citation_journal_title=PloS one;,citation_publisher=Public Library of Science San Francisco, USA;">
<meta name="citation_reference" content="citation_title=Introduction: The coastal ecosystem complex as a unit of structure and function of biological productivity in coastal areas;,citation_author=Yoshiro Watanabe;,citation_author=Tomohiko Kawamura;,citation_author=Yoh Yamashita;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_volume=84;,citation_journal_title=Fisheries science;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=The value of estuarine and coastal ecosystem services;,citation_author=Edward B Barbier;,citation_author=Sally D Hacker;,citation_author=Chris Kennedy;,citation_author=Evamaria W Koch;,citation_author=Adrian C Stier;,citation_author=Brian R Silliman;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_issue=2;,citation_volume=81;,citation_journal_title=Ecological monographs;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=The planetary role of seagrass conservation;,citation_author=Richard KF Unsworth;,citation_author=Leanne C Cullen-Unsworth;,citation_author=Benjamin LH Jones;,citation_author=Richard J Lilley;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_issue=6606;,citation_volume=377;,citation_journal_title=Science;,citation_publisher=American Association for the Advancement of Science;">
<meta name="citation_reference" content="citation_title=Nitrogen uptake responses of gracilaria vermiculophylla (ohmi) papenfuss under combined and single addition of nitrate and ammonium;,citation_author=Maria H Abreu;,citation_author=R Pereira;,citation_author=AH Buschmann;,citation_author=I Sousa-Pinto;,citation_author=C Yarish;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_issue=2;,citation_volume=407;,citation_journal_title=Journal of Experimental Marine Biology and Ecology;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Flora and fauna associated with the introduced red alga gracilaria vermiculophylla;,citation_author=Cecilia D Nyberg;,citation_author=Mads S Thomsen;,citation_author=Inger Wallentinus;,citation_publication_date=2009;,citation_cover_date=2009;,citation_year=2009;,citation_issue=3;,citation_volume=44;,citation_journal_title=European Journal of Phycology;,citation_publisher=Taylor &amp;amp;amp; Francis;">
<meta name="citation_reference" content="citation_title=Combining niche shift and population genetic analyses predicts rapid phenotypic evolution during invasion;,citation_author=Erik E Sotka;,citation_author=Aaron W Baumgardner;,citation_author=Paige M Bippus;,citation_author=Christophe Destombe;,citation_author=Elizabeth A Duermit;,citation_author=Hikaru Endo;,citation_author=Ben A Flanagan;,citation_author=Mits Kamiya;,citation_author=Lauren E Lees;,citation_author=Courtney J Murren;,citation_author=others;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=5;,citation_volume=11;,citation_journal_title=Evolutionary Applications;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=The invasive red alga gracilaria vermiculophylla in the baltic sea: Adaptation to brackish water may compensate for light limitation;,citation_author=Florian Weinberger;,citation_author=Björn Buchholz;,citation_author=Rolf Karez;,citation_author=Martin Wahl;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_issue=3;,citation_volume=3;,citation_journal_title=Aquatic Biology;">
<meta name="citation_reference" content="citation_title=Genetic identification of source and likely vector of a widespread marine invader;,citation_author=Stacy A Krueger-Hadfield;,citation_author=Nicole M Kollars;,citation_author=Allan E Strand;,citation_author=James E Byers;,citation_author=Sarah J Shainker;,citation_author=Ryuta Terada;,citation_author=Thomas W Greig;,citation_author=Mareike Hammann;,citation_author=David C Murray;,citation_author=Florian Weinberger;,citation_author=others;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_issue=12;,citation_volume=7;,citation_journal_title=Ecology and evolution;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Everywhere you look, everywhere you go, there’s an estuary invaded by the red seaweed gracilaria vermiculophylla (ohmi) papenfuss, 1967;,citation_author=Stacy Krueger-Hadfield;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=4;,citation_volume=7;,citation_journal_title=BioInvasions Records;">
<meta name="citation_reference" content="citation_title=Ocean warming alters the responses to eutrophication in a commercially farmed seaweed, gracilariopsis lemaneiformis;,citation_author=Chunxiang Liu;,citation_author=Dinghui Zou;,citation_author=Zhiwei Liu;,citation_author=Changpeng Ye;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_volume=847;,citation_journal_title=Hydrobiologia;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Effects of the invasive macroalgae gracilaria vermiculophylla on two co-occurring foundation species and associated invertebrates;,citation_author=Mads S Thomsen;,citation_author=Peter A Stæhr;,citation_author=Lars Nejrup;,citation_author=David R Schiel;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_issue=2;,citation_volume=8;,citation_journal_title=Aquatic Invasions;,citation_publisher=Regional Euro-Asian Biological Invasions Centre;">
<meta name="citation_reference" content="citation_title=Reintroduction of eelgrass (zostera marina l.) in the dutch wadden sea: A research overview and management vision;,citation_author=MM Van Katwijk;,citation_publication_date=2003;,citation_cover_date=2003;,citation_year=2003;,citation_conference_title=Challenges to the wadden sea area. In: Proceedings of the 10th international scientific wadden sea symposium, groningen, the netherlands;">
<meta name="citation_reference" content="citation_title=Warming impacts on early life stages increase the vulnerability and delay the population recovery of a long-lived habitat-forming macroalga;,citation_author=Pol Capdevila;,citation_author=Bernat Hereu;,citation_author=Roberto Salguero-Gómez;,citation_author=Graciel Rovira;,citation_author=Alba Medrano;,citation_author=Emma Cebrian;,citation_author=Joaquim Garrabou;,citation_author=Diego K Kersting;,citation_author=Cristina Linares;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=3;,citation_volume=107;,citation_journal_title=Journal of Ecology;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=An invasive foundation species enhances multifunctionality in a coastal ecosystem;,citation_author=Aaron P Ramus;,citation_author=Brian R Silliman;,citation_author=Mads S Thomsen;,citation_author=Zachary T Long;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_issue=32;,citation_volume=114;,citation_journal_title=Proceedings of the national academy of sciences;,citation_publisher=National Acad Sciences;">
<meta name="citation_reference" content="citation_title=The global dispersal of the non-endemic invasive red alga gracilaria vermiculophylla in the ecosystems of the euro-asia coastal waters including the wadden sea unesco world heritage coastal area: Awful or awesome?;,citation_author=Vincent Ginneken;,citation_author=Evert Vries;,citation_author=others;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1;,citation_volume=8;,citation_journal_title=Oceanography &amp;amp;amp; Fisheries Open Access Journal;,citation_publisher=Juniper Publishers Inc.;">
</head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Article Notebook</h6>

            <a href="./index.qmd" class="btn btn-primary quarto-download-embed" download="index.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">DISCOV-Gracilaria Paper</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliations</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Simon Oiry¹ <a href="mailto:oirysimon@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-7161-5246" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        
                      </p>
                    <p class="affiliation">
                        Institut des Substances et Organismes de la Mer, ISOMer
                      </p>
                    <p class="affiliation">
                        
                      </p>
                    <p class="affiliation">
                        
                      </p>
                    <p class="affiliation">
                        
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Bede Ffinian Rowe Davies¹ <a href="https://orcid.org/0000-0001-6462-4347" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Pierre Gernez¹ <a href="https://orcid.org/0000-0003-2055-410X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Laurent Barillé¹ <a href="https://orcid.org/0000-0001-5138-2684" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">November 20, 2024</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        To be Written
      </div>
    </div>

    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>Remote Sensing, Invasive species, Coastal Ecosystems, Biodiversity</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#materiel-methods" id="toc-materiel-methods" class="nav-link" data-scroll-target="#materiel-methods"><span class="header-section-number">2</span> Materiel &amp; Methods</a>
  <ul class="collapse">
  <li><a href="#study-sites" id="toc-study-sites" class="nav-link" data-scroll-target="#study-sites"><span class="header-section-number">2.1</span> Study sites</a></li>
  <li><a href="#drone-flights" id="toc-drone-flights" class="nav-link" data-scroll-target="#drone-flights"><span class="header-section-number">2.2</span> Drone flights</a>
  <ul class="collapse">
  <li><a href="#multispectral-data" id="toc-multispectral-data" class="nav-link" data-scroll-target="#multispectral-data"><span class="header-section-number">2.2.1</span> Multispectral data</a></li>
  <li><a href="#lidar-data" id="toc-lidar-data" class="nav-link" data-scroll-target="#lidar-data"><span class="header-section-number">2.2.2</span> LiDAR data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">3</span> Results</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">4</span> Discussion</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">5</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">6</span> References</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <p><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth) </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearthdata) </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Utilities.Package)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'flextable' a été compilé avec la version R 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attachement du package : 'flextable'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Les objets suivants sont masqués depuis 'package:terra':

    align, colorize, rotate, width</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>L'objet suivant est masqué depuis 'package:purrr':

    compose</code></pre>
</div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>my_comma<span class="ot">&lt;-</span>scales<span class="sc">::</span><span class="fu">label_comma</span>(<span class="at">accuracy =</span> <span class="cn">NULL</span>, <span class="at">big.mark =</span> <span class="st">","</span>,<span class="at">decimal.mark =</span> <span class="st">"."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Coastal ecosystems are among the most dynamic and productive environments on Earth, providing ecosystem services and supporting biodiversity <span class="citation" data-cites="unsworth2022planetary barbier2011value watanabe2018introduction">(<a href="#ref-barbier2011value" role="doc-biblioref">Barbier et al., 2011</a>; <a href="#ref-unsworth2022planetary" role="doc-biblioref">Unsworth et al., 2022</a>; <a href="#ref-watanabe2018introduction" role="doc-biblioref">Watanabe et al., 2018</a>)</span>. These ecosystems, spanning mangroves, salt marshes, seagrass meadows, and rocky intertidal zones, play a pivotal role in carbon sequestration, nutrient cycling, and shoreline stabilization <span class="citation" data-cites="liquete2013current mehvar2018quantifying">(<a href="#ref-liquete2013current" role="doc-biblioref">Liquete et al., 2013</a>; <a href="#ref-mehvar2018quantifying" role="doc-biblioref">Mehvar et al., 2018</a>)</span>. They also serve as habitats for numerous species, many of which are commercially or ecologically significant <span class="citation" data-cites="seitz2014ecological de2023valuing">(<a href="#ref-de2023valuing" role="doc-biblioref">De Valck et al., 2023</a>; <a href="#ref-seitz2014ecological" role="doc-biblioref">Seitz et al., 2014</a>)</span>. Coastal areas are densely populated, with billions of people globally depending on their resources for livelihoods, fisheries, and tourism <span class="citation" data-cites="mukherjee2023coastal small2003global">(<a href="#ref-mukherjee2023coastal" role="doc-biblioref">Mukherjee et al., 2023</a>; <a href="#ref-small2003global" role="doc-biblioref">Small and Nicholls, 2003</a>)</span>. However, coastal ecosystems face mounting pressures from human activities such as land reclamation, pollution, and overfishing, compounded by the impacts of climate change <span class="citation" data-cites="lu2018major hall2019ocean">(<a href="#ref-hall2019ocean" role="doc-biblioref">Hall-Spencer and Harvey, 2019</a>; <a href="#ref-lu2018major" role="doc-biblioref">Lu et al., 2018</a>)</span>. Sea level rise, ocean acidification, and increasing storm intensity further exacerbate the vulnerability of these systems, threatening their resilience and the services they provide <span class="citation" data-cites="he2019climate">(<a href="#ref-he2019climate" role="doc-biblioref">He and Silliman, 2019</a>)</span>.</p>
<p>One of the significant threats to coastal ecosystems is biological invasions by non-native species, which can disrupt native biodiversity and alter ecosystem functions <span class="citation" data-cites="krueger2018everywhere capdevila2019warming liu2020ocean">(<a href="#ref-capdevila2019warming" role="doc-biblioref">Capdevila et al., 2019</a>; <a href="#ref-krueger2018everywhere" role="doc-biblioref">Krueger-Hadfield, 2018</a>; <a href="#ref-liu2020ocean" role="doc-biblioref">Liu et al., 2020</a>)</span>. <em>Gracilaria vermiculophylla</em>, an invasive red macroalga native to the northwest Pacific, exemplifies this issue. Over the last century, this species has spread extensively across temperate estuaries in North America, Europe, and other regions, facilitated by aquaculture and maritime activities <span class="citation" data-cites="rueness2005life weinberger2008invasive krueger2017genetic">(<a href="#ref-krueger2017genetic" role="doc-biblioref">Krueger-Hadfield et al., 2017</a>; <a href="#ref-rueness2005life" role="doc-biblioref">Rueness, 2005</a>; <a href="#ref-weinberger2008invasive" role="doc-biblioref">Weinberger et al., 2008</a>)</span>. Its success as an invader stems from its tolerance to a wide range of environmental stressors, including temperature <span class="citation" data-cites="sotka2018combining">(<a href="#ref-sotka2018combining" role="doc-biblioref">Sotka et al., 2018</a>)</span>, salinity <span class="citation" data-cites="weinberger2008invasive">(<a href="#ref-weinberger2008invasive" role="doc-biblioref">Weinberger et al., 2008</a>)</span>, and nutrient variability <span class="citation" data-cites="abreu2011nitrogen">(<a href="#ref-abreu2011nitrogen" role="doc-biblioref">Abreu et al., 2011</a>)</span>, as well as its ability to establish in soft sediment habitats traditionally devoid of macroalgae <span class="citation" data-cites="ramus2017invasive">(<a href="#ref-ramus2017invasive" role="doc-biblioref">Ramus et al., 2017</a>)</span>. While <em>G. vermiculophylla</em> can provide some ecosystem services, such as habitat for invertebrates and juvenile fish, it often outcompetes native vegetation, alters sediment composition <span class="citation" data-cites="nyberg2009flora">(<a href="#ref-nyberg2009flora" role="doc-biblioref">Nyberg et al., 2009</a>)</span>, and disrupts trophic interactions <span class="citation" data-cites="van2018global">(<a href="#ref-van2018global" role="doc-biblioref">Ginneken et al., 2018</a>)</span>. In regions like the Baltic Sea and the eastern United States, it has been documented to negatively affect native fucoids and seagrasses <span class="citation" data-cites="van2003reintroduction thomsen2013effects">(<a href="#ref-thomsen2013effects" role="doc-biblioref">Thomsen et al., 2013</a>; <a href="#ref-van2003reintroduction" role="doc-biblioref">Van Katwijk, 2003</a>)</span>. These impacts underscore the importance of monitoring and managing the spread of <em>G. vermiculophylla</em>, particularly as climate change and anthropogenic pressures continue to facilitate biological invasions.</p>
<p>Remote sensing has revolutionized our ability to monitor and manage ecosystems, offering efficient and scalable methods for detecting environmental changes over large areas <span class="citation" data-cites="davies2024intertidal davies2024sentinel zoffoli2021decadal">(<a href="#ref-davies2024intertidal" role="doc-biblioref">Davies et al., 2024a</a>, <a href="#ref-davies2024sentinel" role="doc-biblioref">2024b</a>; <a href="#ref-zoffoli2021decadal" role="doc-biblioref">Zoffoli et al., 2021</a>)</span>. Among these technologies, drone-based remote sensing has emerged as a particularly promising tool for studying coastal environments <span class="citation" data-cites="roman2023mapping roman2024mapping">(<a href="#ref-roman2024mapping" role="doc-biblioref">Román et al., 2024</a>, <a href="#ref-roman2023mapping" role="doc-biblioref">2023</a>)</span>. Equipped with high-resolution cameras and multispectral or hyperspectral sensors, drones can capture fine-scale spatial and spectral data, enabling researchers to identify and map vegetation, detect stress in plants, and monitor changes over time [<span class="citation" data-cites="roman2021using">Román et al. (<a href="#ref-roman2021using" role="doc-biblioref">2021</a>)</span> ; Oiry et al.&nbsp;2024]. Unlike traditional satellite imagery, drones provide the flexibility to operate in overcast conditions, achieve higher spatial resolution, and target specific areas of interest. For invasive species like <em>G. vermiculophylla</em>, drones equipped with multispectral sensors can differentiate it from native vegetation based on its unique spectral reflectance characteristics (Davies et al.&nbsp;2025). This capability not only enhances detection accuracy but also reduces the time and labor associated with traditional field surveys. As the cost of drone technology continues to decrease and advancements in machine learning facilitate data analysis, drone-based remote sensing is becoming increasingly accessible and impactful for ecological research and management.</p>
<p>In this study, we aim to harness the potential of drone-based multispectral remote sensing to map <em>Gracilaria vermiculophylla</em> in intertidal zones. Bla bla what are we going to do ? bla bla .</p>
</section>
<section id="materiel-methods" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Materiel &amp; Methods</h1>
<section id="study-sites" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="study-sites"><span class="header-section-number">2.1</span> Study sites</h2>
<p>Field campaigns were conducted at three study sites in France and Spain. At each site, two locations were investigated <a href="#fig-location_sites" class="quarto-xref">Figure&nbsp;1</a>. The Aven &amp; Belon Estuary in South Brittany, France (<a href="#fig-location_sites" class="quarto-xref">Figure&nbsp;1</a> A), is a dynamic ria-type system hosting diverse habitats, including sandy tidal flats and subtidal zones with coarse, marine-origin sediments <span class="citation" data-cites="Michel2021 Castaing1995">(<a href="#ref-Castaing1995" role="doc-biblioref">Castaing and Guilcher, 1995</a>; <a href="#ref-Michel2021" role="doc-biblioref">Michel et al., 2021</a>)</span>. These habitats support key benthic species such as <em>Scrobicularia plana</em>, <em>Cerastoderma edule</em>, and <em>Tellina tenuis</em>, which play essential roles in sediment bioturbation and nutrient cycling <span class="citation" data-cites="Tankoua2011 Blanchet2014">(<a href="#ref-Blanchet2014" role="doc-biblioref">Blanchet et al., 2014</a>; <a href="#ref-Tankoua2011" role="doc-biblioref">Tankoua et al., 2011</a>)</span>. The estuary serves as a nursery for juvenile fish and a feeding ground for migratory birds, with its ecological productivity driven by a mix of euryhaline and marine species adapted to salinity gradients <span class="citation" data-cites="Blanchet2014">(<a href="#ref-Blanchet2014" role="doc-biblioref">Blanchet et al., 2014</a>)</span>. Oyster farming, particularly <em>Crassostrea gigas</em>, is a dominant activity, altering sediment dynamics and local biodiversity <span class="citation" data-cites="Michel2021">(<a href="#ref-Michel2021" role="doc-biblioref">Michel et al., 2021</a>)</span>. Despite its ecological richness, the estuary faces pressures from nutrient loading and physical alterations, with bioindicators like <em>S. plana</em> used to monitor the impacts of salinity, sediment quality, and pollution <span class="citation" data-cites="Tankoua2011">(<a href="#ref-Tankoua2011" role="doc-biblioref">Tankoua et al., 2011</a>)</span>.</p>
<p>The Ria d’Étel, located in Brittany, France, is a macrotidal estuary characterized by its unique hydrodynamics and biodiversity (<a href="#fig-location_sites" class="quarto-xref">Figure&nbsp;1</a> B). Influenced predominantly by tidal regimes, the estuary exhibits high-energy zones with strong currents reaching up to 2.5 m/s, shaping both sediment deposition and ecological habitats <span class="citation" data-cites="Portas2023">(<a href="#ref-Portas2023" role="doc-biblioref">Portas et al., 2023</a>)</span>. The estuary supports diverse benthic communities, with sedimentary organic matter originating from both terrestrial inputs and marine sources, contributing to nutrient cycling and benthic fluxes <span class="citation" data-cites="Jeanneau2023">(<a href="#ref-Jeanneau2023" role="doc-biblioref">Jeanneau et al., 2023</a>)</span>. Vegetation gradients transition from halophytic plants in saline zones to freshwater species upstream, reflecting the estuary’s salinity dynamics and ecological complexity <span class="citation" data-cites="Cianfaglione2018">(<a href="#ref-Cianfaglione2018" role="doc-biblioref">Cianfaglione, 2021</a>)</span>. This estuary is also notable for its shellfish farming, with species like <em>Crassostrea gigas</em> cultivated extensively. The presence of filter-feeding organisms such as sponges (<em>Hymeniacidon perlevis</em>) enhances water quality by mitigating bacterial loads and promoting bioremediation <span class="citation" data-cites="Gentric2024">(<a href="#ref-Gentric2024" role="doc-biblioref">Gentric and Sauleau, 2024</a>)</span>. However, the estuary faces environmental pressures, including nutrient enrichment from agricultural runoff and anthropogenic impacts on sedimentary processes.</p>
<p>The Saja-Besaya Estuary, situated along the Cantabrian Sea in northern Spain, is characterized by the confluence of the Saja and Besaya rivers near Torrelavega (<a href="#fig-location_sites" class="quarto-xref">Figure&nbsp;1</a> C). The estuary, also known as San Martín de la Arena or Suances Estuary, has been subject to significant anthropogenic pressures, including industrial developments throughout the 20th century. These activities have led to contamination from mining, paper manufacturing, and carbonate discharges, classifying the estuary as highly polluted near its upper reaches <span class="citation" data-cites="ortega2005fluxes">(<a href="#ref-ortega2005fluxes" role="doc-biblioref">Ortega et al., 2005</a>)</span>. This contamination impacts the estuarine ecosystem, including water quality and biodiversity, with minimal aquatic life and sparse riverbank vegetation in its lower sections <span class="citation" data-cites="romero2008sintering">(<a href="#ref-romero2008sintering" role="doc-biblioref">Romero et al., 2008</a>)</span>.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [3]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">######### Aven Belon </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>mask_aven_belon <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">"Data/shp/mask/mask_site_Aven_Belon_32630.shp"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>HT <span class="ot">&lt;-</span>  <span class="fu">list.files</span>(<span class="st">"Data/Sentinel2/Aven_Belon/S2A_MSIL2A_20231107T111251_N0509_R137_T30TVT_20231107T144858.SAFE/GRANULE/L2A_T30TVT_A043749_20231107T111246/IMG_DATA/R10m/"</span>, <span class="at">pattern =</span> <span class="st">".jp2"</span>,<span class="at">recursive =</span>T,<span class="at">full.names =</span> T)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>B8_HT <span class="ot">&lt;-</span> <span class="fu">rast</span>(HT[<span class="dv">5</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="st">"B08"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_aven_belon, <span class="at">mask =</span> T) </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>B8_HT <span class="ot">&lt;-</span> B8_HT <span class="sc">-</span> <span class="dv">1000</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>B4_HT <span class="ot">&lt;-</span> <span class="fu">rast</span>(HT[<span class="dv">4</span>])<span class="sc">%&gt;%</span> </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="st">"B04"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_aven_belon, <span class="at">mask =</span> T)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>B4_HT <span class="ot">&lt;-</span> B4_HT <span class="sc">-</span><span class="dv">1000</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>NDVI_HT <span class="ot">&lt;-</span> (B8_HT<span class="sc">-</span>B4_HT)<span class="sc">/</span>(B8_HT<span class="sc">+</span>B4_HT)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>LT <span class="ot">&lt;-</span>  <span class="fu">list.files</span>(<span class="st">"Data/Sentinel2/Aven_Belon/S2A_MSIL2A_20240624T110641_N0510_R137_T30TVT_20240624T153247.SAFE/GRANULE/L2A_T30TVT_A047038_20240624T111001/IMG_DATA/R10m/"</span>, <span class="at">pattern =</span> <span class="st">".jp2"</span>,<span class="at">recursive =</span>T,<span class="at">full.names =</span> T)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>B8_LT <span class="ot">&lt;-</span> <span class="fu">rast</span>(LT[<span class="dv">5</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="st">"B08"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_aven_belon, <span class="at">mask =</span> T) </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>B8_LT <span class="ot">&lt;-</span> B8_LT <span class="sc">-</span> <span class="dv">1000</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>B4_LT <span class="ot">&lt;-</span> <span class="fu">rast</span>(LT[<span class="dv">4</span>])<span class="sc">%&gt;%</span> </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="st">"B04"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_aven_belon, <span class="at">mask =</span> T)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>B4_LT <span class="ot">&lt;-</span> B4_LT <span class="sc">-</span><span class="dv">1000</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>NDVI_LT <span class="ot">&lt;-</span> (B8_LT<span class="sc">-</span>B4_LT)<span class="sc">/</span>(B8_LT<span class="sc">+</span>B4_LT)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>intertidal_Aven_Belon <span class="ot">&lt;-</span> NDVI_LT <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> NDVI_HT <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.05</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(intertidal_Aven_Belon)[<span class="fu">values</span>(intertidal_Aven_Belon) <span class="sc">==</span> F] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>mask_sf <span class="ot">&lt;-</span> <span class="fu">as.polygons</span>(intertidal_Aven_Belon) <span class="sc">%&gt;%</span> </span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_cast</span>(<span class="st">"POLYGON"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area =</span> <span class="fu">st_area</span>(geometry)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">as.numeric</span>(area) <span class="sc">&gt;</span> <span class="dv">6500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  nngeo<span class="sc">::</span><span class="fu">st_remove_holes</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  smoothr<span class="sc">::</span><span class="fu">smooth</span>(<span class="at">method =</span> <span class="st">"ksmooth"</span>, <span class="at">smoothness =</span> <span class="dv">3</span>)</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mask_sf)</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="fu">write_sf</span>(mask_sf,<span class="st">"Data/shp/Intertidal_sites/mask_intertidal_Aven_Belon.shp"</span>)</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>Land_Aven_Belon <span class="ot">&lt;-</span> NDVI_LT <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> NDVI_HT <span class="sc">&gt;</span> <span class="fl">0.05</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(Land_Aven_Belon)[<span class="fu">values</span>(Land_Aven_Belon) <span class="sc">==</span> F] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>mask_sf <span class="ot">&lt;-</span> <span class="fu">as.polygons</span>(Land_Aven_Belon) <span class="sc">%&gt;%</span> </span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_cast</span>(<span class="st">"POLYGON"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area =</span> <span class="fu">st_area</span>(geometry)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">as.numeric</span>(area) <span class="sc">&gt;</span> <span class="dv">6500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>  nngeo<span class="sc">::</span><span class="fu">st_remove_holes</span>()</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># smoothr::smooth(method = "ksmooth", smoothness = 3)</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mask_sf)</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a><span class="fu">write_sf</span>(mask_sf,<span class="st">"Data/shp/Intertidal_sites/mask_Land_Aven_Belon.shp"</span>)</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a><span class="do">######### ETEL</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>mask_Etel <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">"Data/shp/mask/mask_site_Etel_32630.shp"</span>)</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>HT <span class="ot">&lt;-</span>  <span class="fu">list.files</span>(<span class="st">"Data/Sentinel2/Etel/S2A_MSIL2A_20231008T110941_N0509_R137_T30TVT_20231008T171550.SAFE/GRANULE/L2A_T30TVT_A043320_20231008T111641/IMG_DATA/R10m/"</span>, <span class="at">pattern =</span> <span class="st">".jp2"</span>,<span class="at">recursive =</span>T,<span class="at">full.names =</span> T)</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>B8_HT <span class="ot">&lt;-</span> <span class="fu">rast</span>(HT[<span class="dv">5</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="st">"B08"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_Etel, <span class="at">mask =</span> T) </span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>B8_HT <span class="ot">&lt;-</span> B8_HT <span class="sc">-</span> <span class="dv">1000</span></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>B4_HT <span class="ot">&lt;-</span> <span class="fu">rast</span>(HT[<span class="dv">4</span>])<span class="sc">%&gt;%</span> </span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="st">"B04"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_Etel, <span class="at">mask =</span> T)</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>B4_HT <span class="ot">&lt;-</span> B4_HT <span class="sc">-</span><span class="dv">1000</span></span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>NDVI_HT <span class="ot">&lt;-</span> (B8_HT<span class="sc">-</span>B4_HT)<span class="sc">/</span>(B8_HT<span class="sc">+</span>B4_HT)</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>LT <span class="ot">&lt;-</span>  <span class="fu">list.files</span>(<span class="st">"Data/Sentinel2/Etel/S2B_MSIL2A_20230718T112119_N0509_R037_T30TVT_20230718T124824.SAFE/GRANULE/L2A_T30TVT_A033239_20230718T112118/IMG_DATA/R10m/"</span>, <span class="at">pattern =</span> <span class="st">".jp2"</span>,<span class="at">recursive =</span>T,<span class="at">full.names =</span> T)</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>B8_LT <span class="ot">&lt;-</span> <span class="fu">rast</span>(LT[<span class="dv">5</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="st">"B08"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_Etel, <span class="at">mask =</span> T) </span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>B8_LT <span class="ot">&lt;-</span> B8_LT <span class="sc">-</span> <span class="dv">1000</span></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>B4_LT <span class="ot">&lt;-</span> <span class="fu">rast</span>(LT[<span class="dv">4</span>])<span class="sc">%&gt;%</span> </span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="st">"B04"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_Etel, <span class="at">mask =</span> T)</span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>B4_LT <span class="ot">&lt;-</span> B4_LT <span class="sc">-</span><span class="dv">1000</span></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>NDVI_LT <span class="ot">&lt;-</span> (B8_LT<span class="sc">-</span>B4_LT)<span class="sc">/</span>(B8_LT<span class="sc">+</span>B4_LT)</span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>intertidal_Etel <span class="ot">&lt;-</span> NDVI_LT <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> NDVI_HT <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.05</span></span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(intertidal_Etel)[<span class="fu">values</span>(intertidal_Etel) <span class="sc">==</span> F] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>mask_sf <span class="ot">&lt;-</span> <span class="fu">as.polygons</span>(intertidal_Etel) <span class="sc">%&gt;%</span> </span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_cast</span>(<span class="st">"POLYGON"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area =</span> <span class="fu">st_area</span>(geometry)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">as.numeric</span>(area) <span class="sc">&gt;</span> <span class="dv">6500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>  nngeo<span class="sc">::</span><span class="fu">st_remove_holes</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>  smoothr<span class="sc">::</span><span class="fu">smooth</span>(<span class="at">method =</span> <span class="st">"ksmooth"</span>, <span class="at">smoothness =</span> <span class="dv">3</span>)</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mask_sf)</span></span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a><span class="fu">write_sf</span>(mask_sf,<span class="st">"Data/shp/Intertidal_sites/mask_intertidal_Etel.shp"</span>)</span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>Land_Etel <span class="ot">&lt;-</span> NDVI_LT <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> NDVI_HT <span class="sc">&gt;</span> <span class="fl">0.05</span></span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(Land_Etel)[<span class="fu">values</span>(Land_Etel) <span class="sc">==</span> F] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>mask_sf <span class="ot">&lt;-</span> <span class="fu">as.polygons</span>(Land_Etel) <span class="sc">%&gt;%</span> </span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_cast</span>(<span class="st">"POLYGON"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area =</span> <span class="fu">st_area</span>(geometry)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">as.numeric</span>(area) <span class="sc">&gt;</span> <span class="dv">6500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>  nngeo<span class="sc">::</span><span class="fu">st_remove_holes</span>() </span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mask_sf)</span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a><span class="fu">write_sf</span>(mask_sf,<span class="st">"Data/shp/Intertidal_sites/mask_Land_Etel.shp"</span>)</span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a><span class="do">######### SAJA</span></span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a>mask_SAJA <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">"Data/shp/mask/mask_site_Saja_32630.shp"</span>)</span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a>HT <span class="ot">&lt;-</span>  <span class="fu">list.files</span>(<span class="st">"Data/Sentinel2/Saja/S2A_MSIL2A_20181004T110911_N0500_R137_T30TVP_20230620T014212.SAFE/GRANULE/L2A_T30TVP_A017151_20181004T111207/IMG_DATA/R10m/"</span>, <span class="at">pattern =</span> <span class="st">".jp2"</span>,<span class="at">recursive =</span>T,<span class="at">full.names =</span> T)</span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a>B8_HT <span class="ot">&lt;-</span> <span class="fu">rast</span>(HT[<span class="dv">5</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="st">"B08"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_SAJA, <span class="at">mask =</span> T) </span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a>B8_HT <span class="ot">&lt;-</span> B8_HT <span class="sc">-</span> <span class="dv">1000</span></span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a>B4_HT <span class="ot">&lt;-</span> <span class="fu">rast</span>(HT[<span class="dv">4</span>])<span class="sc">%&gt;%</span> </span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="st">"B04"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_SAJA, <span class="at">mask =</span> T)</span>
<span id="cb7-154"><a href="#cb7-154" aria-hidden="true" tabindex="-1"></a>B4_HT <span class="ot">&lt;-</span> B4_HT <span class="sc">-</span><span class="dv">1000</span></span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a>NDVI_HT <span class="ot">&lt;-</span> (B8_HT<span class="sc">-</span>B4_HT)<span class="sc">/</span>(B8_HT<span class="sc">+</span>B4_HT)</span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a>LT <span class="ot">&lt;-</span>  <span class="fu">list.files</span>(<span class="st">"Data/Sentinel2/Saja/S2A_MSIL2A_20230928T110831_N0509_R137_T30TVP_20230928T171657.SAFE/GRANULE/L2A_T30TVP_A043177_20230928T111532/IMG_DATA/R10m/"</span>, <span class="at">pattern =</span> <span class="st">".jp2"</span>,<span class="at">recursive =</span>T,<span class="at">full.names =</span> T)</span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a>B8_LT <span class="ot">&lt;-</span> <span class="fu">rast</span>(LT[<span class="dv">5</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="st">"B08"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_SAJA, <span class="at">mask =</span> T) </span>
<span id="cb7-164"><a href="#cb7-164" aria-hidden="true" tabindex="-1"></a>B8_LT <span class="ot">&lt;-</span> B8_LT <span class="sc">-</span> <span class="dv">1000</span></span>
<span id="cb7-165"><a href="#cb7-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a>B4_LT <span class="ot">&lt;-</span> <span class="fu">rast</span>(LT[<span class="dv">4</span>])<span class="sc">%&gt;%</span> </span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="st">"B04"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crop</span>(mask_SAJA, <span class="at">mask =</span> T)</span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a>B4_LT <span class="ot">&lt;-</span> B4_LT <span class="sc">-</span><span class="dv">1000</span></span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a>NDVI_LT <span class="ot">&lt;-</span> (B8_LT<span class="sc">-</span>B4_LT)<span class="sc">/</span>(B8_LT<span class="sc">+</span>B4_LT)</span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a>intertidal_Saja <span class="ot">&lt;-</span> NDVI_LT <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> NDVI_HT <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.05</span></span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(intertidal_Saja)[<span class="fu">values</span>(intertidal_Saja) <span class="sc">==</span> F] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a>mask_sf <span class="ot">&lt;-</span> <span class="fu">as.polygons</span>(intertidal_Saja) <span class="sc">%&gt;%</span> </span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_cast</span>(<span class="st">"POLYGON"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area =</span> <span class="fu">st_area</span>(geometry)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">as.numeric</span>(area) <span class="sc">&gt;</span> <span class="dv">6500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a>  nngeo<span class="sc">::</span><span class="fu">st_remove_holes</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a>  smoothr<span class="sc">::</span><span class="fu">smooth</span>(<span class="at">method =</span> <span class="st">"ksmooth"</span>, <span class="at">smoothness =</span> <span class="dv">3</span>)</span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mask_sf)</span></span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a><span class="fu">write_sf</span>(mask_sf,<span class="st">"Data/shp/Intertidal_sites/mask_intertidal_Saja.shp"</span>)</span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-192"><a href="#cb7-192" aria-hidden="true" tabindex="-1"></a>Land_Saja <span class="ot">&lt;-</span> NDVI_LT <span class="sc">&gt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span> NDVI_HT <span class="sc">&gt;</span> <span class="fl">0.05</span></span>
<span id="cb7-193"><a href="#cb7-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-194"><a href="#cb7-194" aria-hidden="true" tabindex="-1"></a><span class="fu">values</span>(Land_Saja)[<span class="fu">values</span>(Land_Saja) <span class="sc">==</span> F] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-195"><a href="#cb7-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-196"><a href="#cb7-196" aria-hidden="true" tabindex="-1"></a>mask_sf <span class="ot">&lt;-</span> <span class="fu">as.polygons</span>(Land_Saja) <span class="sc">%&gt;%</span> </span>
<span id="cb7-197"><a href="#cb7-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-198"><a href="#cb7-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_cast</span>(<span class="st">"POLYGON"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-199"><a href="#cb7-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area =</span> <span class="fu">st_area</span>(geometry)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-200"><a href="#cb7-200" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">as.numeric</span>(area) <span class="sc">&gt;</span> <span class="dv">6500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-201"><a href="#cb7-201" aria-hidden="true" tabindex="-1"></a>  nngeo<span class="sc">::</span><span class="fu">st_remove_holes</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-202"><a href="#cb7-202" aria-hidden="true" tabindex="-1"></a>  smoothr<span class="sc">::</span><span class="fu">smooth</span>(<span class="at">method =</span> <span class="st">"ksmooth"</span>, <span class="at">smoothness =</span> <span class="dv">3</span>)</span>
<span id="cb7-203"><a href="#cb7-203" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-204"><a href="#cb7-204" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mask_sf)</span>
<span id="cb7-205"><a href="#cb7-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-206"><a href="#cb7-206" aria-hidden="true" tabindex="-1"></a><span class="fu">write_sf</span>(mask_sf,<span class="st">"Data/shp/Intertidal_sites/mask_Land_Saja.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sovereignty10 <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="dv">10</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>world_map <span class="ot">&lt;-</span> sovereignty10 <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sovereignt<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"Spain"</span>,<span class="st">"France"</span>,<span class="st">"Portugal"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Italy"</span>,<span class="st">"Andorra"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"United Kingdom"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Switzerland"</span>,<span class="st">"Belgium"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Germany"</span>,<span class="st">"Luxembourg"</span>) ) </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>bbox_europe <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">20</span>, <span class="at">ymin =</span> <span class="dv">34</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xmax =</span> <span class="dv">20</span>, <span class="at">ymax =</span> <span class="dv">55</span>) ,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="fu">st_crs</span>(world_map) ) </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>world_map<span class="ot">&lt;-</span><span class="fu">st_make_valid</span>(world_map) </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>european_union_map_cropped <span class="ot">&lt;-</span> <span class="fu">st_crop</span>(world_map, bbox_europe)  <span class="sc">%&gt;%</span> </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="st">"+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs "</span>)  </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>UnitedKingdom<span class="ot">&lt;-</span>sovereignty10 <span class="sc">%&gt;%</span> </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(sovereignt<span class="sc">%in%</span><span class="fu">c</span>(<span class="st">"United Kingdom"</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_cast</span>(<span class="st">"POLYGON"</span>) </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>bbox_UK <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">20</span>, <span class="at">ymin =</span> <span class="dv">45</span>,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xmax =</span> <span class="dv">20</span>, <span class="at">ymax =</span> <span class="dv">55</span>) ,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="fu">st_crs</span>(UnitedKingdom) ) </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>UnitedKingdom<span class="ot">&lt;-</span><span class="fu">st_make_valid</span>(UnitedKingdom) </span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>UK_map_cropped <span class="ot">&lt;-</span> <span class="fu">st_crop</span>(UnitedKingdom, bbox_UK)  <span class="sc">%&gt;%</span> </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="st">"+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs "</span>) </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>Europe_sf<span class="ot">&lt;-</span>european_union_map_cropped <span class="sc">%&gt;%</span> </span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(UK_map_cropped) </span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>Projects<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">"France -Ria d'Etel"</span>,</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>  <span class="st">"France - Aven &amp; Belon"</span>,</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Spain - Saja Estuary"</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  ) ,</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">Long=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.187818</span>,</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">3.724905</span>, </span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">4.025402</span>) ,</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lat=</span><span class="fu">c</span>(<span class="fl">47.697566</span>, </span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>        <span class="fl">47.824779</span>,</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>        <span class="fl">43.408356</span>) </span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span> </span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>) )  <span class="sc">%&gt;%</span> </span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="st">"EPSG:4326"</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="st">"+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs "</span>)  </span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>Projects_df<span class="ot">&lt;-</span>Projects <span class="sc">%&gt;%</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">1</span>],</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>                <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>)</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>Miniworld_map <span class="ot">&lt;-</span> sovereignty10 <span class="sc">%&gt;%</span> </span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>)</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>bbox_EU <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">30</span>, <span class="at">ymin =</span> <span class="dv">20</span>,</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xmax =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">70</span>) ,</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="fu">st_crs</span>(Miniworld_map) ) </span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>  MiniEU_map<span class="ot">&lt;-</span><span class="fu">st_crop</span>(Miniworld_map, bbox_EU)  <span class="sc">%&gt;%</span> </span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="st">"+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs "</span>)  </span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>  df_P1<span class="ot">&lt;-</span>Projects_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Site =</span> <span class="fu">case_when</span>(ID <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Ria d'Etel"</span>,</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>                            ID <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Aven &amp; Belon"</span>,</span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>                            ID <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Saja Estuary"</span>,</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>                            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"NA"</span>),</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>           <span class="at">ID =</span> <span class="fu">case_when</span>(ID <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"B"</span>,</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>                          ID <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"A"</span>,</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"C"</span>),</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>           <span class="at">lon_label =</span> <span class="dv">2900000</span>,</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>           <span class="at">lat_label =</span> <span class="fu">case_when</span>(Site <span class="sc">==</span> <span class="st">"Ria d'Etel"</span> <span class="sc">~</span> lat  <span class="sc">-</span> <span class="dv">200000</span>,</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>                                 Site <span class="sc">==</span> <span class="st">"Aven &amp; Belon"</span> <span class="sc">~</span> lat <span class="sc">+</span> <span class="dv">50000</span>,</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>                                 Site <span class="sc">==</span> <span class="st">"Saja Estuary"</span> <span class="sc">~</span> lat  <span class="sc">-</span> <span class="dv">250000</span>,),</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>           <span class="at">lat_ID =</span> lat_label <span class="sc">+</span> <span class="dv">100000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(lon,lat,lon_label,lat_label,lat_ID,ID,Site))</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>    scaleFUN <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(<span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, x),<span class="st">"°N"</span>)</span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(MiniEU_map) <span class="sc">+</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.93</span>, <span class="at">fill =</span> <span class="st">"#CFCFCF"</span>, <span class="at">colour =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> df_P1, <span class="fu">aes</span>(<span class="at">x =</span> lon_label, <span class="at">xend =</span> lon, <span class="at">yend =</span> lat, <span class="at">y =</span>lat_label, <span class="at">group =</span> ID), <span class="at">color =</span> <span class="st">"goldenrod4"</span>,<span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_P1, <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span>lat), <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> df_P1, <span class="fu">aes</span>(<span class="at">x =</span> lon_label, <span class="at">y =</span>lat_label, <span class="at">label =</span> Site), <span class="at">fill =</span> <span class="st">"#FFD27D"</span>,<span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> df_P1, <span class="fu">aes</span>(<span class="at">x =</span> lon_label, <span class="at">y =</span> lat_ID, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"C"</span>)), <span class="at">size =</span> <span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(</span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">2600000</span>, <span class="dv">4100000</span>),</span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1600000</span>, <span class="dv">3100000</span>), </span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="cn">FALSE</span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>() <span class="sc">+</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>) <span class="sc">+</span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">42</span>, <span class="at">labels =</span> scaleFUN) <span class="sc">+</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme_void() +</span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="st">"cm"</span>),</span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">vjust =</span> <span class="fl">7.1</span>, <span class="at">hjust =</span> <span class="fl">0.8</span>),</span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># panel.border = element_rect(color = "black", fill = NA),</span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a>    <span class="co"># panel.background = element_rect(fill = "white"),</span></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot.background = element_rect(fill = "white", color = NA),</span></span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a>    <span class="co"># legend.background = element_rect(fill = "transparent"),</span></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># panel.grid.major = element_line(color = "grey", linetype = "dashed", linewidth = 0.5),</span></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>    <span class="co"># panel.grid.minor = element_line(color = "grey", linetype = "dotted", linewidth = 0.25)</span></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Paper/Figures/High_res/Figure1/Map_Drone_Sites.png"</span>,p1,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">400</span>)  </span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Paper/Figures/Low_res/Figure1/Map_Drone_Sites.png"</span>,p1,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">200</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>create_square_sf <span class="ot">&lt;-</span> <span class="cf">function</span>(side_length, center_lonlat) {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Validate input</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(center_lonlat) <span class="sc">!=</span> <span class="dv">2</span>) {</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Please provide the center coordinates as a vector: c(longitude, latitude)."</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(side_length) <span class="sc">||</span> side_length <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Please provide a positive numeric value for the side length."</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the center point in lon/lat</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  center_point <span class="ot">&lt;-</span> <span class="fu">st_sfc</span>(<span class="fu">st_point</span>(center_lonlat), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transform to EPSG:32630</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  center_point_utm <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(center_point, <span class="dv">32630</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  center_coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(center_point_utm)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate half side length in meters</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  half_side <span class="ot">&lt;-</span> side_length <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the square corners in UTM</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  square_coords <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    center_coords[<span class="dv">1</span>] <span class="sc">-</span> half_side, center_coords[<span class="dv">2</span>] <span class="sc">-</span> half_side,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    center_coords[<span class="dv">1</span>] <span class="sc">+</span> half_side, center_coords[<span class="dv">2</span>] <span class="sc">-</span> half_side,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    center_coords[<span class="dv">1</span>] <span class="sc">+</span> half_side, center_coords[<span class="dv">2</span>] <span class="sc">+</span> half_side,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    center_coords[<span class="dv">1</span>] <span class="sc">-</span> half_side, center_coords[<span class="dv">2</span>] <span class="sc">+</span> half_side,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    center_coords[<span class="dv">1</span>] <span class="sc">-</span> half_side, center_coords[<span class="dv">2</span>] <span class="sc">-</span> half_side <span class="co"># Close the square</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a polygon from the coordinates</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  square_polygon <span class="ot">&lt;-</span> <span class="fu">st_polygon</span>(<span class="fu">list</span>(square_coords))</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create an sf object</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  square_sf <span class="ot">&lt;-</span> <span class="fu">st_sfc</span>(square_polygon, <span class="at">crs =</span> <span class="dv">32630</span>)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(square_sf)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>It_Saja <span class="ot">&lt;-</span> <span class="st">"Data/shp/Intertidal_sites/mask_intertidal_Saja.shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>Land_Saja <span class="ot">&lt;-</span> <span class="st">"Data/shp/Intertidal_sites/mask_Land_Saja.shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>ext_plot_Saja <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">create_square_sf</span>(<span class="dv">5000</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.025987</span>, <span class="fl">43.4200065</span>)))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>Flight_Saja<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Marisma de </span><span class="sc">\n</span><span class="st">Cortiguera"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Marisma de </span><span class="sc">\n</span><span class="st">Cudón"</span>),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Long=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.029591</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">4.031800</span>) ,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lat=</span><span class="fu">c</span>(<span class="fl">43.409738</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        <span class="fl">43.414434</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>) )  <span class="sc">%&gt;%</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="st">"EPSG:4326"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="fu">crs</span>(Land_Saja))  <span class="sc">%&gt;%</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">1</span>],</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lon_label =</span> <span class="fu">case_when</span>(Name <span class="sc">==</span> <span class="st">"Marisma de </span><span class="sc">\n</span><span class="st">Cudón"</span> <span class="sc">~</span> <span class="fl">418639.3</span>,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>                               Name <span class="sc">==</span> <span class="st">"Marisma de </span><span class="sc">\n</span><span class="st">Cortiguera"</span> <span class="sc">~</span> lon <span class="sc">+</span> <span class="dv">2000</span>),</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">lat_label =</span> <span class="fu">case_when</span>(Name <span class="sc">==</span> <span class="st">"Marisma de </span><span class="sc">\n</span><span class="st">Cudón"</span> <span class="sc">~</span> lat <span class="sc">+</span> <span class="dv">1000</span>,</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>                               Name <span class="sc">==</span> <span class="st">"Marisma de </span><span class="sc">\n</span><span class="st">Cortiguera"</span> <span class="sc">~</span> lat <span class="sc">+</span> <span class="dv">500</span>))</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>(plot_Saja <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> Land_Saja, <span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.93</span>, <span class="at">fill =</span> <span class="st">"grey80"</span>) <span class="sc">+</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> It_Saja, <span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.93</span>, <span class="at">fill =</span> <span class="st">"goldenrod"</span>)<span class="sc">+</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(ext_plot_Saja[<span class="dv">1</span>]) <span class="sc">+</span> (<span class="fu">as.numeric</span>(ext_plot_Saja[<span class="dv">3</span>])<span class="sc">-</span><span class="fu">as.numeric</span>(ext_plot_Saja[<span class="dv">1</span>]))<span class="sc">*</span><span class="fl">0.1</span> , </span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">as.numeric</span>(ext_plot_Saja[<span class="dv">2</span>]) <span class="sc">+</span> (<span class="fu">as.numeric</span>(ext_plot_Saja[<span class="dv">4</span>])<span class="sc">-</span><span class="fu">as.numeric</span>(ext_plot_Saja[<span class="dv">2</span>]))<span class="sc">*</span><span class="fl">0.1</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>                   , <span class="at">label =</span> <span class="st">"C"</span>), </span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span> )<span class="sc">+</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(ext_plot_Saja[<span class="dv">1</span>], ext_plot_Saja[<span class="dv">3</span>]),</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(ext_plot_Saja[<span class="dv">2</span>], ext_plot_Saja[<span class="dv">4</span>]),</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> F</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> Flight_Saja, <span class="fu">aes</span>(<span class="at">x =</span> lon_label, <span class="at">xend =</span> lon, <span class="at">yend =</span> lat, <span class="at">y =</span>lat_label, <span class="at">group =</span> Name), <span class="at">color =</span> <span class="st">"goldenrod4"</span>,<span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Flight_Saja, <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span>lat), <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> Flight_Saja, <span class="fu">aes</span>(<span class="at">x =</span> lon_label, <span class="at">y =</span>lat_label, <span class="at">label =</span> Name), <span class="at">fill =</span> <span class="st">"#FFD27D"</span>,<span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Longitude"</span>,</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Latitude"</span>)<span class="sc">+</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="sc">-</span><span class="fl">4.01</span>) <span class="sc">+</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fl">43.415</span>) <span class="sc">+</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Move y-axis to the right</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"white"</span>, <span class="dv">0</span>)),</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">4.5</span>,  <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># Adjust position if needed  )</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Paper/Figures/High_res/Figure1/Map_Saja.png"</span>,plot_Saja,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">400</span>)  </span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Paper/Figures/Low_res/Figure1/Map_Saja.png"</span>,plot_Saja,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">200</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>It_AB <span class="ot">&lt;-</span> <span class="st">"Data/shp/Intertidal_sites/mask_intertidal_Aven_Belon.shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>Land_AB <span class="ot">&lt;-</span> <span class="st">"Data/shp/Intertidal_sites/mask_Land_Aven_Belon.shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>ext_plot_AB <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">create_square_sf</span>(<span class="dv">10000</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.706226</span>, <span class="fl">47.815149</span>)))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>Flight_AB<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Pont du Guilly"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Notre-Dame De Tremor"</span>),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Long=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.655220</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">3.748634</span>) ,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lat=</span><span class="fu">c</span>(<span class="fl">47.822408</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>        <span class="fl">47.837923</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>) )  <span class="sc">%&gt;%</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="st">"EPSG:4326"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="fu">crs</span>(Land_Saja))  <span class="sc">%&gt;%</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">1</span>],</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lon_label =</span> <span class="fu">case_when</span>(Name <span class="sc">==</span> <span class="st">"Pont du Guilly"</span> <span class="sc">~</span> lon <span class="sc">-</span> <span class="dv">1000</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>                               Name <span class="sc">==</span> <span class="st">"Notre-Dame De Tremor"</span> <span class="sc">~</span> lon <span class="sc">+</span> <span class="dv">2000</span>),</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">lat_label =</span> <span class="fu">case_when</span>(Name <span class="sc">==</span>  <span class="st">"Pont du Guilly"</span> <span class="sc">~</span> lat <span class="sc">-</span> <span class="dv">1000</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>                               Name <span class="sc">==</span> <span class="st">"Notre-Dame De Tremor"</span> <span class="sc">~</span> lat <span class="sc">+</span> <span class="dv">1500</span>))</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>(plot_AB <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> Land_AB, <span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.93</span>, <span class="at">fill =</span> <span class="st">"grey80"</span>) <span class="sc">+</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> It_AB, <span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.93</span>, <span class="at">fill =</span> <span class="st">"goldenrod"</span>) <span class="sc">+</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(ext_plot_AB[<span class="dv">1</span>]) <span class="sc">+</span> (<span class="fu">as.numeric</span>(ext_plot_AB[<span class="dv">3</span>])<span class="sc">-</span><span class="fu">as.numeric</span>(ext_plot_AB[<span class="dv">1</span>]))<span class="sc">*</span><span class="fl">0.1</span> , </span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">as.numeric</span>(ext_plot_AB[<span class="dv">2</span>]) <span class="sc">+</span> (<span class="fu">as.numeric</span>(ext_plot_AB[<span class="dv">4</span>])<span class="sc">-</span><span class="fu">as.numeric</span>(ext_plot_AB[<span class="dv">2</span>]))<span class="sc">*</span><span class="fl">0.1</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>                   , <span class="at">label =</span> <span class="st">"A"</span>), </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span> )<span class="sc">+</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(ext_plot_AB[<span class="dv">1</span>], ext_plot_AB[<span class="dv">3</span>]),</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(ext_plot_AB[<span class="dv">2</span>], ext_plot_AB[<span class="dv">4</span>]),</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> F</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> Flight_AB, <span class="fu">aes</span>(<span class="at">x =</span> lon_label, <span class="at">xend =</span> lon, <span class="at">yend =</span> lat, <span class="at">y =</span>lat_label, <span class="at">group =</span> Name), <span class="at">color =</span> <span class="st">"goldenrod4"</span>,<span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Flight_AB, <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span>lat), <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> Flight_AB, <span class="fu">aes</span>(<span class="at">x =</span> lon_label, <span class="at">y =</span>lat_label, <span class="at">label =</span> Name), <span class="at">fill =</span> <span class="st">"#FFD27D"</span>,<span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>()<span class="sc">+</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Longitude"</span>,</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Latitude"</span>)<span class="sc">+</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="sc">-</span><span class="fl">3.7</span>) <span class="sc">+</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fl">47.8</span>) <span class="sc">+</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Move y-axis to the right</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"white"</span>, <span class="dv">0</span>)),</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">7.5</span>,  <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"vertical"</span>,  <span class="co"># Stack legends vertically</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.just =</span> <span class="st">"left"</span>,  <span class="co"># Align the legends to the left</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.0</span>, <span class="st">'mm'</span>),  <span class="co"># Adjust the spacing between items</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"black"</span>),  <span class="co"># Ensure clear legend keys</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> ggplot2<span class="sc">::</span><span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"dotted"</span>, </span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="fu">alpha</span>(<span class="st">"grey30"</span>,<span class="fl">0.5</span>), <span class="at">linewidth =</span> <span class="fl">0.25</span>)</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># Adjust position if needed  )</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Paper/Figures/High_res/Figure1/Map_AB.png"</span>,plot_AB,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">400</span>)  </span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Paper/Figures/Low_res/Figure1/Map_AB.png"</span>,plot_AB,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">200</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>It_Etel <span class="ot">&lt;-</span> <span class="st">"Data/shp/Intertidal_sites/mask_intertidal_Etel.shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>Land_Etel <span class="ot">&lt;-</span> <span class="st">"Data/shp/Intertidal_sites/mask_Land_Etel.shp"</span> <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_sf</span>()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>ext_plot_Etel <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">create_square_sf</span>(<span class="dv">10000</span>, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.186821</span>, <span class="fl">47.683477</span>)))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>Flight_Etel<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Berringue"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Lorois"</span>),</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Long=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.194274</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>         <span class="sc">-</span><span class="fl">3.205714</span>) ,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lat=</span><span class="fu">c</span>(<span class="fl">47.698978</span>,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>        <span class="fl">47.675159</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">%&gt;%</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Long"</span>,<span class="st">"Lat"</span>) )  <span class="sc">%&gt;%</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_crs</span>(<span class="st">"EPSG:4326"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="fu">crs</span>(Land_Saja))  <span class="sc">%&gt;%</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lon =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">1</span>],</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">lat =</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(.) [,<span class="dv">2</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lon_label =</span> <span class="fu">case_when</span>(Name <span class="sc">==</span> <span class="st">"Berringue"</span> <span class="sc">~</span> lon <span class="sc">-</span> <span class="dv">1000</span>,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>                               Name <span class="sc">==</span> <span class="st">"Lorois"</span> <span class="sc">~</span> lon <span class="sc">+</span> <span class="dv">2000</span>),</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">lat_label =</span> <span class="fu">case_when</span>(Name <span class="sc">==</span>  <span class="st">"Berringue"</span> <span class="sc">~</span> lat <span class="sc">+</span> <span class="dv">1000</span>,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>                               Name <span class="sc">==</span> <span class="st">"Lorois"</span> <span class="sc">~</span> lat <span class="sc">-</span> <span class="dv">1000</span>))</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>(plot_Etel <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> Land_Etel, <span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.93</span>, <span class="at">fill =</span> <span class="st">"grey80"</span>) <span class="sc">+</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> It_Etel, <span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.93</span>, <span class="at">fill =</span> <span class="st">"goldenrod"</span>) <span class="sc">+</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(ext_plot_Etel[<span class="dv">1</span>]) <span class="sc">+</span> (<span class="fu">as.numeric</span>(ext_plot_Etel[<span class="dv">3</span>])<span class="sc">-</span><span class="fu">as.numeric</span>(ext_plot_Etel[<span class="dv">1</span>]))<span class="sc">*</span><span class="fl">0.1</span> , </span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">as.numeric</span>(ext_plot_Etel[<span class="dv">2</span>]) <span class="sc">+</span> (<span class="fu">as.numeric</span>(ext_plot_Etel[<span class="dv">4</span>])<span class="sc">-</span><span class="fu">as.numeric</span>(ext_plot_Etel[<span class="dv">2</span>]))<span class="sc">*</span><span class="fl">0.1</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>                   , <span class="at">label =</span> <span class="st">"B"</span>), </span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">10</span>,</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span> )<span class="sc">+</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(ext_plot_Etel[<span class="dv">1</span>], ext_plot_Etel[<span class="dv">3</span>]),</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(ext_plot_Etel[<span class="dv">2</span>], ext_plot_Etel[<span class="dv">4</span>]),</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ndiscr = 1,</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="cn">FALSE</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="sc">-</span><span class="fl">3.2</span>) <span class="sc">+</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fl">47.68</span>) <span class="sc">+</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> Flight_Etel, <span class="fu">aes</span>(<span class="at">x =</span> lon_label, <span class="at">xend =</span> lon, <span class="at">yend =</span> lat, <span class="at">y =</span>lat_label, <span class="at">group =</span> Name), <span class="at">color =</span> <span class="st">"goldenrod4"</span>,<span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Flight_Etel, <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span>lat), <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> Flight_Etel, <span class="fu">aes</span>(<span class="at">x =</span> lon_label, <span class="at">y =</span>lat_label, <span class="at">label =</span> Name), <span class="at">fill =</span> <span class="st">"#FFD27D"</span>,<span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_Bede_Map</span>() <span class="sc">+</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>)<span class="sc">+</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_continuous(breaks = seq(floor(ext_plot_Etel[1]), ceiling(ext_plot_Etel[3]), by = 500)) +</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_continuous(breaks = seq(floor(ext_plot_Etel[2]), ceiling(ext_plot_Etel[4]), by = 500)) +</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="fu">alpha</span>(<span class="st">"white"</span>, <span class="dv">0</span>)),</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">7.5</span>,  <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"vertical"</span>,</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.just =</span> <span class="st">"left"</span>,</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="fl">0.0</span>, <span class="st">'mm'</span>),</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="fu">alpha</span>(<span class="st">"grey30"</span>, <span class="fl">0.5</span>),</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">linewidth =</span> <span class="fl">0.25</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Paper/Figures/High_res/Figure1/Map_Etel.png"</span>,plot_AB,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">400</span>)  </span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Paper/Figures/Low_res/Figure1/Map_Etel.png"</span>,plot_AB,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">200</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [9]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(final_map <span class="ot">&lt;-</span> ((p1 <span class="sc">|</span> plot_AB) <span class="sc">/</span> (plot_Etel <span class="sc">|</span> plot_Saja))  <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)<span class="sc">&amp;</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># theme_void()&amp;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="st">"cm"</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">vjust =</span> <span class="dv">6</span>, <span class="at">hjust =</span> <span class="fl">0.8</span>),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">angle =</span> <span class="dv">90</span>))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Paper/Figures/High_res/Figure1/Map_site.png"</span>,final_map,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">400</span>)  </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"Paper/Figures/Low_res/Figure1/Map_site.png"</span>,final_map,<span class="at">width=</span> <span class="dv">10</span>, <span class="at">height=</span><span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [10]:</pre></div><div id="cell-fig-location_sites" class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"Figures/Low_res/Figure1/Map_site.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-location_sites" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-location_sites-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="Figures/Low_res/Figure1/Map_site.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Location of the drone flights. A: Flights made in Aven &amp; Belon Estuaries, France; B: Flights made in Etel Estuary, France; C: Flights made in Saja Estuaries, Spain. Golden polygons represent intertidal areas."><img src="Figures/Low_res/Figure1/Map_site.png" class="img-fluid figure-img" style="width:95.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-location_sites-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Location of the drone flights. A: Flights made in Aven &amp; Belon Estuaries, France; B: Flights made in Etel Estuary, France; C: Flights made in Saja Estuaries, Spain. Golden polygons represent intertidal areas.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="drone-flights" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="drone-flights"><span class="header-section-number">2.2</span> Drone flights</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [11]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Country =</span> <span class="fu">c</span>(<span class="st">"France"</span>, <span class="st">"France"</span>, <span class="st">"France"</span>, <span class="st">"France"</span>, <span class="st">"Spain"</span>, <span class="st">"Spain"</span>),</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Site =</span> <span class="fu">c</span>(<span class="st">"Aven &amp; Belon"</span>,<span class="st">"Aven &amp; Belon"</span>,<span class="st">"Ria d'Etel"</span>,<span class="st">"Ria d'Etel"</span>, <span class="st">"Saja Estuary"</span>,<span class="st">"Saja Estuary"</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Flight  =</span> <span class="fu">c</span>(<span class="st">"Notre-Dame De Tremor"</span>,<span class="st">"Pont du Guilly"</span>,<span class="st">"Berringue"</span>,<span class="st">"Lorois"</span>,<span class="st">"Marisma de Cortiguera"</span>,<span class="st">"Marisma de Cudón"</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Date =</span> <span class="fu">c</span>(<span class="st">"2024-04-11"</span>,<span class="st">"2024-04-11"</span>,<span class="st">"2023-10-14"</span>,<span class="st">"2023-10-15"</span>,<span class="st">"2024-06-25"</span>,<span class="st">"2024-06-25"</span>), </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Area =</span> <span class="fu">c</span>(<span class="dv">266582</span>,<span class="dv">213064</span>,<span class="dv">25486</span><span class="sc">+</span><span class="dv">127818</span>,<span class="dv">45293</span>,<span class="dv">204133</span>,<span class="dv">83757</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Area =</span> <span class="fu">round</span>(Area <span class="sc">*</span> <span class="fl">0.0001</span>,<span class="dv">1</span>))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>brdr1 <span class="ot">&lt;-</span> <span class="fu">fp_border_default</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>brdr2 <span class="ot">&lt;-</span> <span class="fu">fp_border_default</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>brdr3 <span class="ot">&lt;-</span> <span class="fu">fp_border_default</span>(<span class="at">color =</span> <span class="st">"grey40"</span>, <span class="at">width =</span> <span class="dv">1</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a> i <span class="ot">=</span> <span class="fl">16.5</span> <span class="co"># width of the side borders in the word_document output (in centimeters)</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a> w <span class="ot">=</span> i<span class="sc">*</span><span class="fl">0.3937</span> <span class="co"># width of the side borders in the word_document output (in inches)</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>flx1 <span class="ot">&lt;-</span> <span class="fu">flextable</span>(df)  <span class="sc">%&gt;%</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">width</span>(<span class="at">width =</span> (w<span class="sc">/</span>(<span class="fu">ncol</span>(df)))) <span class="sc">%&gt;%</span> </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge_v</span>(<span class="at">j =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge_v</span>(<span class="at">j =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">border_remove</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline_top</span>(<span class="at">border=</span>brdr1) <span class="sc">%&gt;%</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">6</span>, <span class="at">border=</span>brdr1) <span class="sc">%&gt;%</span> </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">4</span>, <span class="at">border=</span>brdr1) <span class="sc">%&gt;%</span> </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">2</span>, <span class="at">border=</span>brdr1) <span class="sc">%&gt;%</span> </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">1</span>, <span class="at">border=</span>brdr2)<span class="sc">%&gt;%</span> </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">3</span>, <span class="at">border=</span>brdr2)<span class="sc">%&gt;%</span> </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">hline</span>(<span class="at">i=</span><span class="dv">5</span>, <span class="at">border=</span>brdr2) <span class="sc">%&gt;%</span> </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>,<span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>,<span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set_caption(caption = "Table 1 List of drone Flight, summarising the date, the altitude and the purpose of each flight.") %&gt;%</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>) </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="fu">save_as_image</span>(flx1, <span class="st">"Paper/Figures/High_res/table_flights.png"</span>, <span class="at">res =</span> <span class="dv">400</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<section id="multispectral-data" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="multispectral-data"><span class="header-section-number">2.2.1</span> Multispectral data</h3>
<p>At each location (<a href="#tbl-flights" class="quarto-xref">Table&nbsp;1</a>), reflectance images with a resolution of 1.2 million pixels were captured using a DJI Matrice 300 quadcopter drone equipped with a Micasense RedEdge Dual MX multispectral camera. The camera recorded data across ten spectral bands, spanning from blue to near-infrared (NIR) wavelengths (444, 475, 531, 560, 650, 668, 705, 717, 740, and 840 nm) (). To ensure consistent lighting conditions, the drone’s flight trajectory was aligned to maintain a solar azimuth angle of 90 degrees. Image acquisition was carried out with an overlap of 70% between side-by-side images and 80% between successive images along the flight path. A downwelling light sensor (DLS2) was used to measure real-time irradiance, enabling the correction of reflectance values for variations in light intensity caused by cloud cover during the flight. The raw image data were subsequently calibrated to reflectance using a calibration panel with ~50% reflectivity, provided by the camera’s manufacturer. Images were processed using structure-from-motion photogrammetry software <span class="citation" data-cites="agisoft">(<a href="#ref-agisoft" role="doc-biblioref">Agisoft, 2019</a>)</span> to generate multispectral orthomosaics for each flight. The orthomosaicking workflow was consistent across all flights. Initially, key tie points were identified within each image and across overlapping images to create a sparse point cloud. This point cloud was refined by removing noisy points using a reprojection accuracy metric. Subsequently, a dense point cloud was generated using a structure-from-motion algorithm. A digital surface model (DSM) was then created through surface interpolation of the dense point cloud, which served as the basis for reconstructing the multispectral ortho-image <span class="citation" data-cites="nebel2020review">(<a href="#ref-nebel2020review" role="doc-biblioref">Nebel et al., 2020</a>)</span>. The resolution of the multispectral orthomosaic obtained were 8 cm per pixel.</p>
</section>
<section id="lidar-data" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="lidar-data"><span class="header-section-number">2.2.2</span> LiDAR data</h3>
<p>Using the Matrice 300 Series Dual Gimbal Connector, a DJI Zenmuse L1 LiDAR and RGB sensor was mounted on the drone alongside a multispectral camera. This setup enabled the simultaneous capture of LiDAR point clouds, high-resolution RGB images, and multispectral images collected by the MicaSense RedEdge Dual MX during the same flight. The same processing workflow was applied to process LiDAR RGB images, resulting in orthomosaic with a resolution of 2.5 cm per pixel. Since the mapping focused solely on flat surfaces without dense vegetation, the LiDAR measured only a single return. Operating in repetitive scanning mode with a sampling rate of 240 kHz, the system achieved a point density of 350 points per square meter. The LiDAR point cloud was extracted and converted into LAS format using DJI Terra software. The LAS point cloud was then imported into Agisoft Metashape <span class="citation" data-cites="agisoft">(<a href="#ref-agisoft" role="doc-biblioref">Agisoft, 2019</a>)</span> to generate a DEM with a resolution of 2.5 cm.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [12]:</pre></div><div class="cell">

<div class="cell-container"><div class="cell-decorator"><pre>In [13]:</pre></div><div class=""><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"Figures/High_res/table_flights.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-flights" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-flights-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: List of drone flights, summarising the location, the date, and the total extent of each flight (in hectars).
</figcaption>
<div aria-describedby="tbl-flights-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<div class="cell-output-display">
<div class="">
<figure class="figure">
<p class=""><a href="Figures/High_res/table_flights.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Table&nbsp;1: List of drone flights, summarising the location, the date, and the total extent of each flight (in hectars)."><img src="Figures/High_res/table_flights.png" class="img-fluid figure-img" width="1326"></a></p>
</figure>
</div>
</div>
</div>
</figure>
</div></div></div>
</div></div>
</section>
</section>
</section>
<section id="results" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Results</h1>
</section>
<section id="discussion" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Discussion</h1>
</section>
<section id="conclusion" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Conclusion</h1>
</section>
<section id="references" class="level1 unnumbered" data-number="6">
<h1 class="unnumbered" data-number="6"><span class="header-section-number">6</span> References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-abreu2011nitrogen" class="csl-entry" role="listitem">
Abreu, M.H., Pereira, R., Buschmann, A., Sousa-Pinto, I., Yarish, C., 2011. Nitrogen uptake responses of gracilaria vermiculophylla (ohmi) papenfuss under combined and single addition of nitrate and ammonium. Journal of Experimental Marine Biology and Ecology 407, 190–199.
</div>
<div id="ref-agisoft" class="csl-entry" role="listitem">
Agisoft, 2019. <a href="https://www.agisoft.com/">Agisoft metashape</a>.
</div>
<div id="ref-barbier2011value" class="csl-entry" role="listitem">
Barbier, E.B., Hacker, S.D., Kennedy, C., Koch, E.W., Stier, A.C., Silliman, B.R., 2011. The value of estuarine and coastal ecosystem services. Ecological monographs 81, 169–193.
</div>
<div id="ref-Blanchet2014" class="csl-entry" role="listitem">
Blanchet, H., Gouillieux, B., Alizier, S., others, 2014. Multiscale patterns in the diversity and organization of benthic intertidal fauna among french atlantic estuaries. Journal of Sea Research 90, 95–110. <a href="https://doi.org/10.1016/j.seares.2014.02.014">https://doi.org/10.1016/j.seares.2014.02.014</a>
</div>
<div id="ref-capdevila2019warming" class="csl-entry" role="listitem">
Capdevila, P., Hereu, B., Salguero-Gómez, R., Rovira, G. la, Medrano, A., Cebrian, E., Garrabou, J., Kersting, D.K., Linares, C., 2019. Warming impacts on early life stages increase the vulnerability and delay the population recovery of a long-lived habitat-forming macroalga. Journal of Ecology 107, 1129–1140.
</div>
<div id="ref-Castaing1995" class="csl-entry" role="listitem">
Castaing, P., Guilcher, A., 1995. Morphosedimentary evolution of ria-type estuaries. Earth Surface Processes and Landforms 20, 361–376. <a href="https://doi.org/10.1002/esp.3290200408">https://doi.org/10.1002/esp.3290200408</a>
</div>
<div id="ref-Cianfaglione2018" class="csl-entry" role="listitem">
Cianfaglione, K., 2021. Plant landscape and models of french atlantic estuarine systems: Extended summary of the doctoral thesis. Transylvanian Review of Systematical and Ecological Research 23, 15–36. <a href="https://doi.org/10.2478/trser-2021-0002">https://doi.org/10.2478/trser-2021-0002</a>
</div>
<div id="ref-davies2024sentinel" class="csl-entry" role="listitem">
Davies, B.F.R., Oiry, S., Rosa, P., Zoffoli, M.L., Sousa, A.I., Thomas, O.R., Smale, D.A., Austen, M.C., Biermann, L., Attrill, M.J., others, 2024b. A sentinel watching over inter-tidal seagrass phenology across western europe and north africa. Communications Earth &amp; Environment 5, 382.
</div>
<div id="ref-davies2024intertidal" class="csl-entry" role="listitem">
Davies, B.F.R., Oiry, S., Rosa, P., Zoffoli, M.L., Sousa, A.I., Thomas, O.R., Smale, D.A., Austen, M.C., Biermann, L., Attrill, M.J., others, 2024a. Intertidal seagrass extent from sentinel-2 time-series show distinct trajectories in western europe. Remote Sensing of Environment 312, 114340.
</div>
<div id="ref-de2023valuing" class="csl-entry" role="listitem">
De Valck, J., Jarvis, D., Coggan, A., Schirru, E., Pert, P., Graham, V., Newlands, M., 2023. Valuing ecosystem services in complex coastal settings: An extended ecosystem accounting framework for improved decision-making. Marine Policy 155, 105761.
</div>
<div id="ref-Gentric2024" class="csl-entry" role="listitem">
Gentric, C., Sauleau, P., 2024. Bacterial load mitigation of the shellfish magallana gigas by the marine sponge hymeniacidon perlevis (montagu 1818). Regional Studies in Marine Science 75, 103564. <a href="https://doi.org/10.1016/j.rsma.2024.103564">https://doi.org/10.1016/j.rsma.2024.103564</a>
</div>
<div id="ref-van2018global" class="csl-entry" role="listitem">
Ginneken, V. van, Vries, E. de, others, 2018. The global dispersal of the non-endemic invasive red alga gracilaria vermiculophylla in the ecosystems of the euro-asia coastal waters including the wadden sea unesco world heritage coastal area: Awful or awesome? Oceanography &amp; Fisheries Open Access Journal 8, 4–26.
</div>
<div id="ref-hall2019ocean" class="csl-entry" role="listitem">
Hall-Spencer, J.M., Harvey, B.P., 2019. Ocean acidification impacts on coastal ecosystem services due to habitat degradation. Emerging Topics in Life Sciences 3, 197–206.
</div>
<div id="ref-he2019climate" class="csl-entry" role="listitem">
He, Q., Silliman, B.R., 2019. Climate change, human impacts, and coastal ecosystems in the anthropocene. Current Biology 29, R1021–R1035.
</div>
<div id="ref-Jeanneau2023" class="csl-entry" role="listitem">
Jeanneau, L., Jardé, E., Louis, J., Pannard, A., Liotaud, M., Andrieux-Loyer, F., Gruau, G., Caradec, F., Rabiller, E., Lebris, N., Laverman, A., 2023. How the origin of sedimentary organic matter impacts the benthic nutrient fluxes in shallow coastal mudflats. Comptes Rendus Géoscience 355, 237–258. <a href="https://doi.org/10.5802/crgeos.228">https://doi.org/10.5802/crgeos.228</a>
</div>
<div id="ref-krueger2018everywhere" class="csl-entry" role="listitem">
Krueger-Hadfield, S., 2018. Everywhere you look, everywhere you go, there’s an estuary invaded by the red seaweed gracilaria vermiculophylla (ohmi) papenfuss, 1967. BioInvasions Records 7.
</div>
<div id="ref-krueger2017genetic" class="csl-entry" role="listitem">
Krueger-Hadfield, S.A., Kollars, N.M., Strand, A.E., Byers, J.E., Shainker, S.J., Terada, R., Greig, T.W., Hammann, M., Murray, D.C., Weinberger, F., others, 2017. Genetic identification of source and likely vector of a widespread marine invader. Ecology and evolution 7, 4432–4447.
</div>
<div id="ref-liquete2013current" class="csl-entry" role="listitem">
Liquete, C., Piroddi, C., Drakou, E.G., Gurney, L., Katsanevakis, S., Charef, A., Egoh, B., 2013. Current status and future prospects for the assessment of marine and coastal ecosystem services: A systematic review. PloS one 8, e67737.
</div>
<div id="ref-liu2020ocean" class="csl-entry" role="listitem">
Liu, C., Zou, D., Liu, Z., Ye, C., 2020. Ocean warming alters the responses to eutrophication in a commercially farmed seaweed, gracilariopsis lemaneiformis. Hydrobiologia 847, 879–893.
</div>
<div id="ref-lu2018major" class="csl-entry" role="listitem">
Lu, Y., Yuan, J., Lu, X., Su, C., Zhang, Y., Wang, C., Cao, X., Li, Q., Su, J., Ittekkot, V., others, 2018. Major threats of pollution and climate change to global coastal ecosystems and enhanced management for sustainability. Environmental Pollution 239, 670–680.
</div>
<div id="ref-mehvar2018quantifying" class="csl-entry" role="listitem">
Mehvar, S., Filatova, T., Dastgheib, A., De Ruyter van Steveninck, E., Ranasinghe, R., 2018. Quantifying economic value of coastal ecosystem services: A review. Journal of marine science and engineering 6, 5.
</div>
<div id="ref-Michel2021" class="csl-entry" role="listitem">
Michel, G., Le Bot, S., Lesourd, S., Lafite, R., 2021. Morpho-sedimentological and dynamic patterns in a ria type estuary: The belon estuary (south brittany, france). Journal of Maps 17, 389–400. <a href="https://doi.org/10.1080/17445647.2021.1925170">https://doi.org/10.1080/17445647.2021.1925170</a>
</div>
<div id="ref-mukherjee2023coastal" class="csl-entry" role="listitem">
Mukherjee, S., Ghosh, K.K., Chanda, A., 2023. Coastal pollution—an overview. Environmental Oceanography and Coastal Dynamics: Current Scenario and Future Trends 99–107.
</div>
<div id="ref-nebel2020review" class="csl-entry" role="listitem">
Nebel, S., Beege, M., Schneider, S., Rey, G.D., 2020. A review of photogrammetry and photorealistic 3D models in education from a psychological perspective, in: Frontiers in Education. Frontiers Media SA, p. 144.
</div>
<div id="ref-nyberg2009flora" class="csl-entry" role="listitem">
Nyberg, C.D., Thomsen, M.S., Wallentinus, I., 2009. Flora and fauna associated with the introduced red alga gracilaria vermiculophylla. European Journal of Phycology 44, 395–403.
</div>
<div id="ref-ortega2005fluxes" class="csl-entry" role="listitem">
Ortega, T., Ponce, R., Forja, J., Gómez-Parra, A., 2005. Fluxes of dissolved inorganic carbon in three estuarine systems of the cantabrian sea (north of spain). Journal of Marine Systems 53, 125–142.
</div>
<div id="ref-Portas2023" class="csl-entry" role="listitem">
Portas, A., Carriot, N., Ortalo-Magné, A., Damblans, G., Thiébaut, M., Culioli, G., Quillien, N., Briand, J.-F., 2023. Impact of hydrodynamics on community structure and metabolic production of marine biofouling formed in a highly energetic estuary. Marine Environmental Research 192, 106241. <a href="https://doi.org/10.1016/j.marenvres.2023.106241">https://doi.org/10.1016/j.marenvres.2023.106241</a>
</div>
<div id="ref-ramus2017invasive" class="csl-entry" role="listitem">
Ramus, A.P., Silliman, B.R., Thomsen, M.S., Long, Z.T., 2017. An invasive foundation species enhances multifunctionality in a coastal ecosystem. Proceedings of the national academy of sciences 114, 8580–8585.
</div>
<div id="ref-roman2024mapping" class="csl-entry" role="listitem">
Román, A., Oiry, S., Davies, B.F., Rosa, P., Gernez, P., Tovar-Sánchez, A., Navarro, G., Méléder, V., Barillé, L., 2024. Mapping intertidal microphytobenthic biomass with very high-resolution remote sensing imagery in an estuarine system. Science of The Total Environment 177025.
</div>
<div id="ref-roman2023mapping" class="csl-entry" role="listitem">
Román, A., Prasyad, H., Oiry, S., Davies, B.F., Brunier, G., Barillé, L., 2023. Mapping intertidal oyster farms using unmanned aerial vehicles (UAV) high-resolution multispectral data. Estuarine, Coastal and Shelf Science 291, 108432.
</div>
<div id="ref-roman2021using" class="csl-entry" role="listitem">
Román, A., Tovar-Sánchez, A., Olivé, I., Navarro, G., 2021. Using a UAV-mounted multispectral camera for the monitoring of marine macrophytes. Frontiers in Marine Science 8, 722698.
</div>
<div id="ref-romero2008sintering" class="csl-entry" role="listitem">
Romero, M., Andrés, A., Alonso, R., Viguri, J., Rincón, J.M., 2008. Sintering behaviour of ceramic bodies from contaminated marine sediments. Ceramics International 34, 1917–1924.
</div>
<div id="ref-rueness2005life" class="csl-entry" role="listitem">
Rueness, J., 2005. Life history and molecular sequences of gracilaria vermiculophylla (gracilariales, rhodophyta), a new introduction to european waters. Phycologia 44, 120–128.
</div>
<div id="ref-seitz2014ecological" class="csl-entry" role="listitem">
Seitz, R.D., Wennhage, H., Bergström, U., Lipcius, R.N., Ysebaert, T., 2014. Ecological value of coastal habitats for commercially and ecologically important species. ICES Journal of Marine Science 71, 648–665.
</div>
<div id="ref-small2003global" class="csl-entry" role="listitem">
Small, C., Nicholls, R.J., 2003. A global analysis of human settlement in coastal zones. Journal of coastal research 584–599.
</div>
<div id="ref-sotka2018combining" class="csl-entry" role="listitem">
Sotka, E.E., Baumgardner, A.W., Bippus, P.M., Destombe, C., Duermit, E.A., Endo, H., Flanagan, B.A., Kamiya, M., Lees, L.E., Murren, C.J., others, 2018. Combining niche shift and population genetic analyses predicts rapid phenotypic evolution during invasion. Evolutionary Applications 11, 781–793.
</div>
<div id="ref-Tankoua2011" class="csl-entry" role="listitem">
Tankoua, O.F., Buffet, P.-E., Amiard, J.-C., Amiard-Triquet, C., Mouneyrac, C., Berthet, B., 2011. Potential influence of confounding factors (size, salinity) on biomarkers in the sentinel species scrobicularia plana used in programmes monitoring estuarine quality. Environmental Science and Pollution Research 18, 1253–1263. <a href="https://doi.org/10.1007/s11356-011-0479-3">https://doi.org/10.1007/s11356-011-0479-3</a>
</div>
<div id="ref-thomsen2013effects" class="csl-entry" role="listitem">
Thomsen, M.S., Stæhr, P.A., Nejrup, L., Schiel, D.R., 2013. Effects of the invasive macroalgae gracilaria vermiculophylla on two co-occurring foundation species and associated invertebrates. Aquatic Invasions 8, 133–145.
</div>
<div id="ref-unsworth2022planetary" class="csl-entry" role="listitem">
Unsworth, R.K., Cullen-Unsworth, L.C., Jones, B.L., Lilley, R.J., 2022. The planetary role of seagrass conservation. Science 377, 609–613.
</div>
<div id="ref-van2003reintroduction" class="csl-entry" role="listitem">
Van Katwijk, M., 2003. Reintroduction of eelgrass (zostera marina l.) in the dutch wadden sea: A research overview and management vision, in: Challenges to the Wadden Sea Area. In: Proceedings of the 10th International Scientific Wadden Sea Symposium, Groningen, the Netherlands. pp. 173–195.
</div>
<div id="ref-watanabe2018introduction" class="csl-entry" role="listitem">
Watanabe, Y., Kawamura, T., Yamashita, Y., 2018. Introduction: The coastal ecosystem complex as a unit of structure and function of biological productivity in coastal areas. Fisheries science 84, 149–152.
</div>
<div id="ref-weinberger2008invasive" class="csl-entry" role="listitem">
Weinberger, F., Buchholz, B., Karez, R., Wahl, M., 2008. The invasive red alga gracilaria vermiculophylla in the baltic sea: Adaptation to brackish water may compensate for light limitation. Aquatic Biology 3, 251–264.
</div>
<div id="ref-zoffoli2021decadal" class="csl-entry" role="listitem">
Zoffoli, M.L., Gernez, P., Godet, L., Peters, S., Oiry, S., Barillé, L., 2021. Decadal increase in the ecological status of a north-atlantic intertidal seagrass meadow observed with multi-mission satellite time-series. Ecological Indicators 130, 108033.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Institut des Substances et Organismes de la Mer, ISOMer, Nantes Université, UR 2160, F-44000 Nantes, France<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script> 
  
</body></html>